# Meta-Analysis of 20 Orphan GPCRs

## Project Overview

This project performs a comprehensive bioinformatics meta-analysis of 20 orphan G-protein coupled receptors (GPCRs). The goal is to leverage public data and modern machine learning techniques to uncover hidden relationships and generate novel hypotheses about their function.

The analysis pipeline includes:
1.  Automated data retrieval from the RCSB PDB.
2.  Protein sequence extraction.
3.  Electrostatic potential analysis using APBS.
4.  High-dimensional feature extraction using the ESM-2 protein language model.
5.  Clustering and visualization using UMAP and K-Means.

## Directory Structure

The project is organized into the following directories:

-   `/pdb_files/`: Stores the raw protein structure files (.pdb and .cif) downloaded from the PDB.
-   `/metadata/`: Stores the corresponding metadata for each structure in JSON format.
-   `/scripts/`: Contains all the Python scripts required to run the analysis pipeline.
-   `/results/`: Contains the final outputs of the analysis, including visualizations.

## Environment Setup

This project uses `conda` to manage its environment and dependencies, ensuring full reproducibility.

1.  **Install Conda**: If you don't have it, install [Miniconda](https://docs.conda.io/en/latest/miniconda.html) or [Anaconda](https://www.anaconda.com/products/distribution).

2.  **Create the Environment**: Navigate to the project root directory and create the conda environment using the provided `environment.yml` file. This will install all the necessary packages.

    ```bash
    conda env create -f environment.yml
    ```

3.  **Activate the Environment**: Before running any scripts or launching the notebook, activate the new environment.

    ```bash
    conda activate orphan-gpcr-analysis
    ```

---

## Analysis Pipeline & How to Reproduce

To reproduce this analysis, follow the steps below. Ensure you have the necessary dependencies installed (see individual script headers).

### Step 1: Data Acquisition

Run the `download_data.py` script to fetch all the required protein structure and metadata files. This script uses the `target20.csv` file as input.

```bash
python scripts/download_data.py
```

### Step 2: Sequence Extraction

Next, extract the protein sequences from the downloaded structure files into a single FASTA file. This is a necessary input for the protein language model.

```bash
python scripts/extract_sequences_from_pdb.py
```

This will create a `sequences.fasta` file in the root directory.

### Step 3: Generate ESM-2 Embeddings (Manual Step on Google Colab)

This step requires a GPU and is best performed on Google Colab.

1.  **Open Google Colab** and create a new notebook.
2.  **Set the runtime** to use a **T4 GPU** (`Runtime` -> `Change runtime type`).
3.  **Upload** the `sequences.fasta` file to your Colab environment.
4.  **Copy and paste** the provided Colab script into a cell and run it. This will install dependencies, download the ESM-2 model, and generate the embeddings.
5.  **Download** the resulting `embeddings.pt` file and place it in the root of this project directory.

### Step 4: Final Analysis (Jupyter Notebook)

With the embeddings file in place, the final step is to explore the results interactively. 

1.  **Launch Jupyter**: Open the `Orphan_GPCR_Analysis.ipynb` notebook in a Jupyter environment (like Jupyter Lab or VS Code).
2.  **Run the Cells**: Execute the cells sequentially to load the data, perform the UMAP and K-Means analysis, and generate the final visualization directly within the notebook.

This notebook is the primary output of this project and contains the full, reproducible analysis narrative.

### (Optional) Step 5: Electrostatic Analysis

To perform the electrostatic analysis, you will need to have `PDB2PQR` and `APBS` installed and configured in your environment.

```bash
python scripts/run_electrostatics.py
```
This will generate intermediate files and `.dx` maps for visualization in tools like PyMOL.

## Key Files

-   `target20.csv`: The initial input file defining the 20 orphan GPCR targets.
-   `embeddings.pt`: The high-dimensional embeddings for each protein sequence, generated by the ESM-2 model. **This file is critical and must be generated via the Colab step.**
-   `results/orphan_gpcr_cluster_analysis_umap.png`: The final, interpretable visualization of the protein relationships.
